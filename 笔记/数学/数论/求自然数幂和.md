# 求自然数幂和

形如 $f_m(n)=\sum_{i=0}^n i^m$ 的柿子称为自然数幂和。

## 扰动法

当要求 $f_m(n)=\sum_{i=0}^n i^m$ 时（$m\ge 1$），能推式子（应用两次搅动法）得：
$$
\begin{aligned}
f_{m+1}(n)=&\sum_{i=0}^n i^{m+1}\\
=&\sum_{i=0}^n (i+1)^{m+1}\ -(n+1)^{m+1}\\
=&\sum_{i=0}^n\sum_{j=0}^{m+1} \binom{m+1}{j} i^j\ -(n+1)^{m+1}\\
=&\sum_{j=0}^{m+1}\binom{m+1}{j}f_j(n)\ -(n+1)^{m+1}\\
=&\sum_{j=0}^{m-1}\binom{m+1}{j}f_j(n)\ +(m+1)f_{m}(n) +f_{m+1}(n)-(n+1)^{m+1}
\end{aligned}
$$
所以有：
$$
f_m(n)=\frac{(n+1)^{m+1}-\sum_{j=0}^{m-1}\binom{m+1}{j}f_j(n)}{m+1}
$$
直接算时间复杂度为 $O(m^2)$，用分治 FFT 优化能做到 $O(m\log^2 m)$，该方法也可说明 $f_m(n)$ 为 $m+1$ 次多项式。

## 拉格朗日插值法

既然可得 $f_m(n)$ 为 $m+1$ 次多项式，那么直接代入 $0\sim m+1$ 的 $f_m$ 的值能得到：
$$
f_m(n)=\sum_{i=0}^{m+1}f_m(i)\prod_{j\ne i}\frac{n-j}{i-j}
$$
因为取值连续，求和部分可以 $O(n)$ 预处理后达到 $O(n)$ 的时间复杂度，求 $0\sim m+1$ 的值时，因为 $g_m(i)=i^m$ 为积性函数，可以直接线性筛求，质数的话就直接快速幂算，而质数的个数约为 $O(\frac{m}{\ln m})$，所以时间复杂度约为 $O(\frac{m}{\ln m} \log m)=O(n)$。

## 第一类斯特林数

待补

## 第二类斯特林数

待补

## 伯努利数

待补

