# 二分图最大匹配

一张图 $G$ 是二分图当且仅当 $G$ 的点集 $V$ 可以分为两个点集 $V_0,V_1$，满足 $V_0∪V_1=V$，$V_0∩V_1=∅$，且对于 $G$ 的每条边 $e$，其两个端点分别属于不同的点集。

用自然语言来描述就是，一张图是二分图，当且仅当它的点可以被分成两部分，而这张图上的所有边的两个端点，都分属不同的部分。

我们称这两个点集，一个叫左部，一个叫右部。左部中的点叫左部点；右部中的点叫右部点。

图 $G$ 的一个匹配是 $G$ 的一个边集 $E_0$，满足 $E_0$ 中的所有边都没有公共端点。

用自然语言来描述就是，一张图的一个匹配是一些没有公共端点的边。

可以想象，对于一个二分图而言，显然一个匹配是对于每一个左部点，连一条边向一个右部点，或者不向右部点连边。但是每个左部点不会对应两个或以上的右部点。

### 匈牙利算法

匈牙利算法正确性基于 $Hall$ 定理，本质是不断寻找增广路来扩大匹配数。

> ##### $Hall$ 定理
>
> 给定一个二分图，我们记 $L,R$ 分别为其两边的点。对于 $S⊆L$，我们令 $N(S)$ 表示**直接**连到 $S$ 的所有右边的点。
>
> 如果对任意 $S⊆L$，都有 $|N(S)|\ge S$，那么最大匹配数为 $|L|$（即左边的每个点都能被匹配上）。特别的，如果 $|L|=|R|$，则此时存在完美匹配。
>
> 注意到这个条件显然是充要条件，因为存在完美匹配时对每个 $S⊆L$，只是与 $S$ 匹配的点就也有 $S$ 个；与 $S$ 直接相连的点肯定更多。
>
> > 证明概要：对点数归纳。如果存在一个子集 $T⊆L$ 使得 $|N(T)|=|T|$，那么不难证明整张图去掉 $T$ 和 $N(T)$ 中的点之后仍然满足 $Hall$ 条件。（并且显然 $T$ 和 $N(T)$ 中的点单独拿出来满足 $Hall$ 条件）。所以这样就拆成了两个点数更小的问题。
> >
> > 如果不存在这样的 $T$，那么我们随便从二分图里面删边，直到它存在为止。可以证明在此之前不会破坏 $Hall$ 条件。
>
> 证明参考了 [这篇 blog](https://riteme.site/blog/2016-9-19/hall-theorem.html)。

参考了 [这篇 blog](https://www.luogu.com.cn/blog/rqy/hall-theorem-regular-bigraph)。

匈牙利的过程相当于每次选一个左部点 $u$，然后枚举一个与它连边的右部点 $v$，若右部点 $v$ 尚未匹配左部点则将 $u$ 匹配 $v$，否则继续去判断 $v$ 的“原配”是否能和其他点匹配，如若不能则点 $u$ 失配。

容易发现这是一个递归的过程，时间复杂度为 $O(n\times e+m)$ （$n,m,e$ 分别为左部点个数、右部点个数、边数）

### Dinic

$Dinic$ 是网络流算法，在二分图中，我们可以用流量为 $inf$ 的边将左部点连向一个超级源点 $S$、右部点连向一个超级汇点 $T$，原本二分图的每条边看做流量为 $1$ 的边，显然最大流即为二分图最大匹配。