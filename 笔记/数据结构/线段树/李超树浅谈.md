## 李超线段树

> 李超线段树是一种用于维护平面直角坐标系内线段关系的数据结构。它常被用来处理这样一种形式的问题：给定一个平面直角坐标系，支持动态插入一条线段，询问与直线 $x=K$ 相交且交点的 $y$ 最大的线段。
>
> 李超线段树的核心是维护每个区间的“最优势线段”，即在每个区间的中点处最高的线段。询问时我们可以对所有包含横坐标为 $K$ 的位置的区间上的最优势线段计算答案，最后取个 $MAX$。
>
> 其实这就相当于维护一个记录当前区间最优势线段的线段树。

### 修改操作

首先插入一条线段时要现在线段树上找到被线段完全包含的区间再进行修改操作，每次修改操作具体如下：

1. 如果当前区间没有线段，那么这个线段直接成为”最优势线段“
2. 设优线段为 $A$、劣线段为 $B$，若 $B$ 与 $x=l$ 的交点在 $A$ 与 $x=l$ 的交点之上，则 $A$、$B$ 在 $[l,mid]$ 肯定有交点，用劣线段修改右部区间，若 $B$ 与 $x=r$ 的交点在 $A$ 与 $x=r$ 的交点之上，则 $A$、$B$ 在 $[mid+1,r]$ 肯定有交点，用劣线段修改右部区间，如果没有交点那么直接返回

### 查询操作

查询就和线段树单点查询差不多，只不过访问到的所有区间都有可能是答案，所以要取 $MAX$

#### ps：

[李超线段树可以使用标记永久化来存储区间线段最值 QwQ，并且只要满足一个区间内的 $x$ 单调不减就可以用李超线段树]([P4069 [SDOI2016\] 游戏 - 洛谷 | 计算机科学教育新生态 (luogu.com.cn)](https://www.luogu.com.cn/problem/P4069))

