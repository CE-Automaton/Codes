# 题目

## A. 经典(classic)

### 题目描述

你有一篇“经典”和一个“套路”，两者各自是一个小写字母组成的一个字符串。

时间流逝，“经典”和“套路”都会变长。具体地，每次发生历史事件时，它们两者之一会在开头或者结尾增加一个小写字母。

你想要知道，在历史上的若干个时刻，那时候的“套路”在“经典”里作为子串出现了多少次。

---

更准确的描述如下：初始你有一个“经典”字符串 $A$ 和一个“套路”字符串 $B$，都非空，由小写字母组成。

然后按时间顺序输入历史上发生的 $n$ 件事，每件事为以下 $5$ 种之一：

- $\texttt{1 c}$ 表示在 $A$ 开头增加一个小写字母 $\texttt{c}$
- $\texttt{2 c}$ 表示在 $A$ 结尾增加一个小写字母 $\texttt{c}$
- $\texttt{3 c}$ 表示在 $B$ 开头增加一个小写字母 $\texttt{c}$
- $\texttt{4 c}$ 表示在 $B$ 结尾增加一个小写字母 $\texttt{c}$
- $\texttt{5}$ 表示询问此时 $B$ 在 $A$ 中作为子串出现了多少次，更准确地说，是询问此时有多少个 $1\le i\le \lvert A\rvert-\lvert B\rvert+1$ 满足 $A[i:i+\lvert B\rvert -1] = B$（字符串下标由 $1$ 开始，$A[x:y]$ 表示 $A$ 从第 $x$ 到 $y$ 个字符组成的子串，包括第 $x,y$ 个字符。$\lvert A\rvert$ 表示 $A$ 的长度。）

### 输入格式

从文件 `classic.in` 中读入数据。

第一行一个非空小写字母字符串表示 $A$ 的初始值。

第二行一个非空小写字母字符串表示 $B$ 的初始值。

第三行一个正整数 $n$ 表示事件次数。

接下来 $n$ 行，每行是题目描述中的 $5$ 种格式之一，表示一个事件。

### 输出格式

输出到文件 `classic.out` 中。

依次对于每个第 $\texttt{5}$ 种事件，输出一行一个非负整数表示当时 $B$ 在 $A$ 中作为子串出现的次数。

### 样例

#### 样例 1 输入

```plain
ababc
a
7
5
4 b
5
3 a
1 a
5
5
```

#### 样例 1 输出

```plain
2
2
1
1
```

### 数据范围与提示

设 $M_1$ 为最后一次操作后的 $\lvert A\rvert + \lvert B\rvert$ 的总长度，$M_2$ 为第 $\texttt{5}$ 种事件的次数，$M=\max(M_1,M_2)$。

对于所有的数据，$M\le 10^6$。

本题采用子任务测试。

|子任务编号|分数|$M\le$|
|:-:|:-:|:-:|
|$1$|$30$|$2000$|
|$2$|$30$|$10^5$|
|$3$|$40$|$10^6$|

## B. 点分治树(dac)

### 题目描述

你有一棵 $n$ 个点的树 $T$，点的编号 $1$ 到 $n$，现在你要对它建立点分治树 $D$。你希望点分治树不要太深，所以用一个层级值范围 $k$ 限制了它的深度。

具体来说，点分治树 $D$ 是一棵 $n$ 个点的有根树，点的编号 $1$ 到 $n$。我们称 $T$ 和 $D$ 中编号相同的点是对应的。点分治树必须满足：

- 点分治树的每个子树都满足：子树内的所有点在原树 $T$ 中对应的点形成一个连通块。
- 点分治树的每个非根点 $i$ 都满足：记 $i$ 的点分治树父亲为 $v$，点分治树上以 $i$ 为根的子树内存在一个点 $u$，使得 $u,v$ 在原树上对应的点相邻。
- 点分治树的每个点 $i$ 有一个层级值 $h_i$，是一个正整数，且满足 $1\le h_i\le k$。
- 点分治树中父亲节点的层级值总是严格小于孩子节点，也就是说 $D$ 关于 $h$ 是一个小根堆。

请你求出 $T$ 可能的不同的点分治树个数，对 $998244353$ 取模。

两个点分治树不同，当且仅当根不同或者存在一个点的父亲不同或者存在一个点的层级值不同。

### 输入格式

从文件 `dac.in` 中读入数据。

第一行两个正整数 $n,k$ 表示树的点数和层级值范围。

接下来 $n-1$ 行，每行两个正整数 $u,v$ 表示 $T$ 中 $u,v$ 之间有边。

保证输入的 $n-1$ 条边形成一棵树。

### 输出格式

输出到文件 `dac.out` 中。

输出一行一个非负整数表示可能的不同点分治树个数对 $998244353$ 取模的结果。

### 样例

#### 样例 1 输入

```plain
4 2
1 2
1 3
1 4
```

#### 样例 1 输出

```plain
1
```

#### 样例 1 解释

由于层级值上限只有 $2$，只能考虑深度不超过 $2$ 的点分治树。那么只能是以 $1$ 为根，其它点点分治树父亲都为 $1$，且 $h_1=1, h_2=h_3=h_4=2$，这一种方案。

### 数据范围与提示

对于所有数据，$1\le n\le 50, 1\le k\le 17$。

本题共有 $20$ 个测试点，每个 $5$ 分，部分分限制如下：

|测试点编号|$n\le $|$k\le $|
|:-:|:-:|:-:|
|$1\sim 2$|$4$|$4$|
|$3\sim 6$|$7$|$7$|
|$7\sim 10$|$50$|$8$|
|$11\sim 14$|$50$|$15$|
|$15\sim 20$|$50$|$17$|

## C. 最小生成森林并(forest)

### 题目描述

你有两个无向图 $G,H$，分别有 $n$ 个点，各自的点都标号为 $1$ 到 $n$。

$G$ 有 $a$ 条边，$H$ 有 $b$ 条边，并且每条边分别有正整数权值 $w$。

现在你要找到 $G$ 的一个生成森林 $F_G$ 和 $H$ 的一个生成森林 $F_H$。生成森林指的是不含环的子图。一个方案的总权值指的是 $F_G$ 中边权最大值与 $F_H$ 中边权最大值相加求和的结果。

定义两个数 $u,v$ 是可达的，当且仅当在 $F_G$ 和 $F_H$ 二者至少一个之中 $u,v$ 号点联通。

现在请你求出，在 $1$ 到 $n$ 形成的 $\binom{n}{2}$ 个不同数对中可达的至少有 $k$ 对的前提下，总权值的最小可能值是多少。如果不存在符合条件的方案，输出 $-1$。

此处 $\binom{n}{2}=\frac{n(n-1)}{2}$。

### 输入格式

从文件 `forest.in` 中读入数据。

第一行四个非负整数 $n,a,b,k$ 分别表示图的点数，$G$ 的边数，$H$ 的边数，可达数对的条件。

接下来 $a$ 行每行三个整数 $u,v,w$ 表示 $G$ 中的 $u,v$ 之间有一条边权为 $w$ 的边。

接下来 $b$ 行每行三个整数 $u,v,w$ 表示 $H$ 中的 $u,v$ 之间有一条边权为 $w$ 的边。

### 输出格式

输出到文件 `forest.out` 中。

输出一行一个整数，表示总权值的最小可能值，$-1$ 表示不存在符合条件的方案。

### 样例

#### 样例 1 输入

```plain
10 0 0 1
```

#### 样例 1 输出

```plain
-1
```

#### 样例 1 解释

没有边，所以不可能有可达点对。无解。

#### 样例 2 输入

```plain
6 4 4 9
1 2 1
2 3 2
1 4 3
3 4 4
5 6 40
1 5 30
2 6 20
3 6 10
```

#### 样例 2 输出

```plain
33
```

#### 样例 2 解释

$F_G$ 中最大权为 $3$，$F_H$ 中最大权为 $30$ 时最优。此时，$F_G$ 含边 $(1,2),(2,3),(1,4)$，$F_H$ 含边 $(1,5),(2,6),(3,6)$。可达点对包括 $(1,2),(1,3),(1,4),(1,5),(2,3),(2,4),(2,6),(3,4),(3,6)$ 共 $9$ 对。

### 数据范围与提示

对于所有数据，$1\le n\le 2\times 10^5, 0\le a,b\le 2\times 10^5, 0\le k\le \binom{n}{2}, 1\le u,v\le n, 1\le w\le 10^9$。

本题采用子任务测试。

|子任务编号|分数|特殊性质|
|:-:|:-:|:-:|
|$1$|$20$|$n\le 2000$|
|$2$|$20$|$G$ 的边端点都是奇数，$H$ 的边端点都是偶数。|
|$3$|$25$|$a\le 10$|
|$4$|$35$|无|