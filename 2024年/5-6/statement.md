# <center>NOI 模拟赛 by CQYC</center>

|     题目名称      |  长佳蕊  | 有趣的游戏 |    矩阵    |
| :---------------: | :------: | :--------: | :--------: |
|     题目类型      |  传统型  |   传统型   |   传统型   |
|   可执行文件名    |   grow   |    game    |   matrix   |
|    输入文件名     | grow.in  |  game.in   | matrix.in  |
|    输出文件名     | grow.out |  game.out  | matrix.out |
|  每个测试点时限   |  2.5 秒  |   0.5 秒   |    1 秒    |
|     内存限制      |  512 MB  |   512 MB   |   512 MB   |
| 子任务/测试点数目 |    5     |     4      |     12     |
|     是否等分      |    否    |     否     |     否     |

提交源文件程序名

| 对于C++语言 | grow.cpp | game.cpp | matrix.cpp |
| ----------- | -------- | -------- | ---------- |

编译选项

| 对于C++语言 | -lm -std=c++14 -O2 -Wl,--stack=2147483647 |
| ----------- | ----------------------------------------- |

**注意事项(请仔细阅读)**

1. ⽂件名（程序名和输⼊输出⽂件名）必须使用英文小写。
2. C/C++ 中函数 `main()` 的返回类型必须是 `int` ，程序正常结束时返回值必须是0。
3. 选手提交的程序代码文件请**直接放在个人目录下，不需要建立子文件夹**。
4. 若无特殊说明，结果的比较方式为全文比较（过滤行末空格及文末回车）。
5. 选手提交的程序源文件必须不大于 50KB。
6. 程序可使用的栈空间内存限制于题目的内存限制一致。
7. 使用 `std::deque` 等 STL 容器时，请注意其内存空间消耗。
8. 评测在 Windows 11 下进行，使用 LemonLime 进行评测。
9. 若开启捆绑测试，为了避免数据过多，评测时可能会有符合数据范围的子任务依赖。
10. 题目较简单，喧哗的选手请不要大声 AK。

<div STYLE="page-break-after: always;"></div>

## 长佳蕊（grow）

### 题目描述

注意看，眼前这个男人叫小 **Z**，在阳光明媚的一天他决定出来散步。

路上有着一排的种着的花，每朵花都长着及其美妙的花蕊，经过小 **Z** 的仔细观察，他发现这些花为单性花并且每朵花都只有一根花蕊，但小 **Z** 辨别不出一些花蕊的雌雄，小 **Z** 也并不想出生物题考验大家（这太难了），所以他想到了信息学中的 $01$ 串——他很早以前看过一本杂志书，书上定义了这种花的花蕊佳值为花蕊的雌/雄分别对应 $0$/$1$ 时这些花蕊最终得到的二进制数的结果，书上还写着“这种花一定满足最终的花蕊佳值为平方数”。

小 **Z** 相信这些花最终只有一种合理的花蕊佳值，并且他想知道这些花的花蕊佳值，现在他找到了你，请你帮帮小 **Z** 吧！

#### 简要题面

给定一个二进制数 $s$​ ，但它的若干位置被换成了 `?` 。你需要求出一种把 `?` 替换成 01 的方案，使得替换之后得到一个平方数。

保证方案存在且唯一，保证 $s$ 最高位是 $1$ 。

### 输入格式

一行一个字符串 $s$。

### 输出格式

输出替换后的二进制数。

### 样例 #1

#### 样例输入 #1

```
1
```

#### 样例输出 #1

```
1
```

### 样例 #2

#### 样例输入 #2

```
1???
```

#### 样例输出 #2

```
1001
```

### 样例 #3

#### 样例输入 #3

```
10??110??00??1000??
```

#### 样例输出 #3

```
1011110110000100001
```

### 样例 #4

见下发文件。

### 数据范围

本题采用**捆绑测试**。

对于 $100\%$ 的数据，$1\le |s|\le 125$，且 $\sum [s_i=\texttt{?}] \le 40,\ s_1=1$；

Subtask 1（5 pts）：$|s| \le 1$；

Subtask 2（15 pts）：$|s|\le 60$ 且 $\sum [s_i=\texttt{?}] \le 20$；

Subtask 3（15 pts）：保证 $s$ 的最低位为 `?`，且 `?` 为连续段；

Subtask 4（15 pts）：保证 $s$ 的次高位为 `?`，且 `?` 为连续段；

Subtask 5（50 pts）：无特殊限制。

<div STYLE="page-break-after: always;"></div>

## 有趣的游戏（game）

### 题目描述

Alice 和 Bob 又在玩游戏。

游戏规则如下：

初始时，每人获得 $N$ 张卡，每张卡上有一个从 $[1,10^{18}]$ 内随机选取的整数。

还有 $N$ 个位置，从 $1$ 到 $N$ 编号。

Alice 先放卡，使得每个位置恰好有一张她的卡。之后 Bob 可以看 Alice 放的卡，再放他自己的卡，使得每个位置恰好也有一张他的卡。最后对于每个位置 $i$，谁的卡上的数大谁就可以获得 $i$ 分。如果相同，则各得 $\frac{i}{2}$ 分。

两人都希望自己的得分尽量大，并足够聪明（Bob 总是会最大化自己的得分，而 Alice 则希望最大化自己的期望得分）。

注意 Alice 只知道自己的卡，而 Bob 可以知道自己的卡和 Alice 的卡和放法。

给定 $N$，求 Alice 的期望得分。

### 输入格式

一行一个正整数 $N$。

### 输出格式

一行一个数表示答案，四舍五入保留 $6$ 位小数。

### 样例 #1

#### 样例输入 #1

```
2
```

#### 样例输出 #1

```
1.333333
```

### 样例 #2

#### 样例输入 #2

```
7
```

#### 样例输出 #2

```
9.168415
```

### 样例 #3

#### 样例输入 #3

```
99
```

#### 样例输出 #3

```
589.631287
```

### 数据范围

本题采用**捆绑测试**。

对于 $100\%$ 的数据，$1\le N\le 100$，且 $N$ 为整数。

Subtask 1（10 pts）：$N\le 1$。 

Subtask 2（20 pts）：$N\le 4$。 

Subtask 3（30 pts）：$N\le 10$。 

Subtask 4（40 pts）：无特殊限制。

<div STYLE="page-break-after: always;"></div>

## 矩阵（matrix）

### 题目描述

给定一个 $n\times m$，值域 $[0,9]$ 的矩阵 $B$，请你计数有多少个大小相同的矩阵 $A$ 满足下列条件：

- 分别对 $A$ 的**每一列**中元素从小到大排序，再分别对 $A$ 的**每一行**中元素从小到大排序能够得到 $B$；
- 分别对 $A$ 的**每一行**中元素从小到大排序，再分别对 $A$ 的**每一列**中元素从小到大排序能够得到 $B$。

$1\le n,m\le 1500$​​，答案对 $998244353$ 取模。

### 输入格式

第一行两个整数 $n,m$；

接下来输入一个 $n$ 行 $m$ 列的矩阵 $B$。

### 输出格式

一行一个整数：满足条件的矩阵 $A$ 的数目，答案对 $998244353$ 取模。

### 样例 #1

#### 样例输入 #1

```
2 2
0 0
1 2
```

#### 样本输出 #1

```
4
```

#### 样例解释 #1

满足条件的四个矩阵是：$\begin{pmatrix}0&0\\1&2\end{pmatrix}$ , $\begin{pmatrix}0&0\\2&1\end{pmatrix}$ , $\begin{pmatrix}1&2\\0&0\end{pmatrix}$ , $\begin{pmatrix}2&1\\0&0\end{pmatrix}$ 。

例如，我们可以验证 $\begin{pmatrix}2&1\\0&0\end{pmatrix}$ 是否满足以下条件：

- 先进行行排序，再进行列排序： $\begin{pmatrix}2&1\\0&0\end{pmatrix}\to \begin{pmatrix}1&2\\0&0\end{pmatrix} \to \begin{pmatrix}0&0\\1&2\end{pmatrix}$；
  
- 先进行列排序，再进行行排序： $\begin{pmatrix}2&1\\0&0\end{pmatrix}\to \begin{pmatrix}0&0\\2&1\end{pmatrix} \to \begin{pmatrix}0&0\\1&2\end{pmatrix}$。

### 样例 #2

#### 样例输入 #2

```
3 3
0 1 3
2 4 7
5 6 8
```

#### 样例输出 #2

```
576
```

#### 样例解释 #2

例如，$\begin{pmatrix}5&7&6\\3&0&1\\4&8&2\end{pmatrix}$ 满足条件，可以验证如下：

- 先进行行排序，再进行列排序：$\begin{pmatrix}5&7&6\\3&0&1\\4&8&2\end{pmatrix}\to \begin{pmatrix}5&6&7\\0&1&3\\2&4&8\end{pmatrix} \to \begin{pmatrix}0&1&3\\2&4&7\\5&6&8\end{pmatrix}$；
  
- 先进行列排序，再进行行排序：$\begin{pmatrix}5&7&6\\3&0&1\\4&8&2\end{pmatrix}\to \begin{pmatrix}3&0&1\\4&7&2\\5&8&6\end{pmatrix} \to \begin{pmatrix}0&1&3\\2&4&7\\5&6&8\end{pmatrix}$。

### 样例 #3

#### 样例输入 #3

```
3 5
0 0 0 1 1
0 0 1 1 2
0 1 1 2 2
```

#### 样例输出 #3

```
10440
```

### 样例 #4

#### 样例输入 #4

```
1 7
2 3 3 6 8 8 9
```

#### 样例输出 #4

```
1260
```

### 样例 #5

见下发文件。

### 样例 #6

见下发文件。

### 样例 #7

见下发文件。

### 数据范围

本题采用**捆绑测试**。

对于全部数据：

- $1\leq n, m\leq 1500$；
- $0\leq B_{i,j}\leq 9$；
- 对于任意 $1\leq i\leq n$ 和 $1\leq j\leq m - 1$ , $B_{i,j}\leq B_{i,j+1}$；
- 对于任意 $1\leq j\leq m$ 和 $1\leq i\leq n - 1$ ，$B_{i,j}\leq B_{i+1,j}$；
- 所有输入值均为整数。

对于部分数据：（记 $n,m$ 的最大值为 $N$）

| 子任务编号 | N | 性质 A | 性质 B | 分值 |
| :----------- | :----------- | :----------- | ------------ | ------------ |
| 1 | $N \le 1$ | $\sqrt{}$ | $\sqrt{}$ | 1 |
| 2 | $N \le 2$ |  |  | 9 |
| 3 | $N \le 4$ |  | $\sqrt{}$ | 10 |
| 4 | $N \le 100$ | $\sqrt{}$ |  | 5 |
| 5 | $N \le 100$ |  | $\sqrt{}$ | 5 |
| 6 | $N \le 100$ |  |  | 10 |
| 7 | $N \le 500$ | $\sqrt{}$ |  | 5 |
| 8 | $N \le 500$ |  | $\sqrt{}$ | 5 |
| 9 | $N \le 500$ |  |  | 10 |
| 10 | $N \le 1500$ | $\sqrt{}$ |  | 10 |
| 11 | $N \le 1500$ |  | $\sqrt{}$ | 10 |
| 12 | $N \le 1500$ |  |  | 20 |

**A**：$n=1$ **或** $m=1$； 

**B**：对于任意 $1 \le i \le n$ 和 $1\le j \le m$，$B_{i,j} \le 1$。