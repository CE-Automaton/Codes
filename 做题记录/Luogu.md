## [P4069 [SDOI2016] 游戏]([P4069 [SDOI2016\] 游戏 - 洛谷 | 计算机科学教育新生态 (luogu.com.cn)](https://www.luogu.com.cn/problem/P4069))

涉及算法：李超线段树、重链剖分

首先因为点 $r$ 到点 $s$ 的 $dis$ 不好弄，看到 $a\times dis+b$ 是一次函数，很像李超线段树做的东西，那么我们把 $s$ 到 $t$ 分为 $s$ 到 $lca$ 和 $t$ 到 $lca$ 两段，将第一、二段的 $dis_{r,s}$ 分别转化为 $dis_{1,s}-dis_{1,r}$、$dis_{1,s}+dis_{1,r}-2\times dis_{1, lca}$，那么第一、二段的函数分别为 $-a\times dis_{1,r}+a\times dis_{1, s}+b$、$a\times dis_{1,r}+a\times (dis_{1,s}-2\times dis_{1, lca})+b$，又因为 $lca$ 到 $s$、$t$ 的路径上的 $dis_{1,r}$ 都递增，所以可以使用李超线段树套上个重链剖分，而要求的最小值可以标记永久化，并且插入线段的最值一定在线段的两个端点 QwQ

完结撒花✿✿ヽ(°▽°)ノ✿

## [P3527 [POI2011] MET-Meteors]([P3527 [POI2011\] MET-Meteors - 洛谷 | 计算机科学教育新生态 (luogu.com.cn)](https://www.luogu.com.cn/problem/P3527))

涉及算法：整体二分、树状数组

可以发现这道题能够二分，但每个询问都单独二分的话时间复杂度受不了（关键在于 check 的时间复杂度），所以使用整体二分，将每次操作看作差分用树状数组来维护，再用一个指针每次添加或者删除操作即可

完结撒花✿✿ヽ(°▽°)ノ✿

## [P4183 [USACO18JAN] Cow at Large P](https://www.luogu.com.cn/problem/P4183)

涉及算法：点分治、树状数组

题面略了，根据题意，首先我们能想到一个 $O(n^2)$ 的方法：先预处理每个点 $i$ 到叶子结点的最小值 $g_i$，然后枚举根 $rt$，当 $dis_{rt,i} \ge g_i$ 时，农夫一定能从叶子结点走到当前节点，那么当前节点及其子树肯定就不会被贝茜走到，于是直接 ***dfs***，走到点 $i$ 满足 $dis_{rt,i} \ge g_i$，则答案 $+1$，并且不继续遍历子树

当前做法瓶颈在于要枚举根节点才能确定每个点的子树，那么我们就要让答案和枚举的根节点无关，首先考虑让答案和“子树”限制无关，能发现之前走到的满足 $dis_{rt,i} \ge g_i$ 的点 $i$ 的儿子们也满足该条件，而该子树对答案贡献的 $1$ 可以看作是点数减边数，那么我们把每个叶子点赋为 $1$，其他点都赋为 $1-儿子数=2-度数$ 就可以直接求满足 $dis_{rt,i} \ge g_i$ 的所有点的权值和了，具体做法直接上点分治，把 $dis_{rt,i}\ge g_i$ 转化为 $dep_{rt}+dep_i\ge g_i$，即 $dep_{rt} \ge g_i-dep_i$，然后套上个树状数组就做完啦（值得注意的是 $g_i-dep_i$ 有可能小于等于 $0$，所以要 $+n$）

完结撒花✿✿ヽ(°▽°)ノ✿

## [P5384 [Cnoi2019] 雪松果树](https://www.luogu.com.cn/problem/P5384)

涉及算法：线段树合并

题面略，这题原本空间限制为 $128$ MB，后面改了，所以可以直接线段树合并做

发现答案就是查询以 $k$ 级祖先为子树的与 $u$ 深度相同的点的个数 $-1$（不能算自己），然后线段树合并就可以做啦~找 $k$ 级祖先可以直接 dfs 一遍 QwQ